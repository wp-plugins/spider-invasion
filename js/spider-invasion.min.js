function getRandomPosition(e){var t=jQuery.noConflict();var n=t("body").height()-e.height();var r=t("body").width()-e.width();var i=Math.floor(Math.random()*n);var s=Math.floor(Math.random()*r);return[i,s]}function runSpawnAnimation(e){e.animate({width:"35px",height:"21px",marginLeft:"-15",marginTop:"-7"},400,function(){e.animate({width:"50px",height:"30px",marginLeft:"-21",marginTop:"-10"},50,function(){e.shake()})})}function spawnSpider(){var e=jQuery.noConflict();var t=spider_invasion_param.images_dir+"/cute-spider-"+(Math.floor(Math.random()*3)+1)+".png";var n=e("<img/>").css({position:"absolute",opacity:.5,width:"50px",height:"30px","z-index":100}).addClass("spider-invader").attr("src",t).appendTo("body").hide();var r=getRandomPosition(n);r[1]+=10;n.css({width:"1px",height:"1px"});if(!spider_invasion_param.invade_content){var i="#content";if(e(i).length>0&&r[1]>e(i).offset().left-n.height()&&r[1]<e(i).offset().left+e(i).width()&&r[0]>e(i).offset().top&&r[0]<e(i).offset().top+e(i).height())return}n.css({top:r[0]+"px",left:r[1]+"px"});n.show();runSpawnAnimation(n);var s=305;var o=r[1]-100+s;var u=r[1]-100;var a=e("<div/>").css({position:"absolute",top:r[0]-140+"px",left:r[1]-150+"px",opacity:.5,width:(o>e("body").width()?e("body").width()-u:s)+"px",height:"275px","z-index":50,overflow:"hidden"}).addClass("spider-danger-zone").appendTo("body").data("spider",n);n.data("danger-zone",a)}function spawnSpidersAtRandomIntervals(e){var t=jQuery.noConflict();spawnSpider();++e;if(t("body").height()*t("body").width()/(500*500)<e)return;setTimeout(function(){spawnSpidersAtRandomIntervals(e)},Math.floor(Math.random()*6e4)+5e3)}function zigzagDefense(e){if(e.position().top<-50)return;e.animate({left:"+=13",top:"-=25"},30,"linear").animate({left:"-=13",top:"-=25"},30,"linear",function(){zigzagDefense(e)});e.data("danger-zone").remove()}(function(e){e.fn.shake=function(t){var n={shakes:4,distance:3,duration:200};if(t){e.extend(n,t)}var r;return this.each(function(){$this=e(this);r=$this.css("position");var t=0;if(!r||r==="static"){$this.css("position","relative")}else if(r==="absolute"){t=$this.position().left}for(var i=1;i<=n.shakes;i++){$this.animate({left:t+n.distance*-1},n.duration/n.shakes/4).animate({left:t+n.distance},n.duration/n.shakes/2).animate({left:t+0},n.duration/n.shakes/4)}})}})(jQuery);jQuery(document).ready(function(){var e=jQuery.noConflict();spider_invasion_param.max_density=+spider_invasion_param.max_density;spider_invasion_param.min_density=+spider_invasion_param.min_density;spider_invasion_param.nb_spiders=+spider_invasion_param.nb_spiders;spider_invasion_param.invade_content=Boolean(spider_invasion_param.invade_content);var t=e("body").height()*e("body").width();var n=Math.floor(t/spider_invasion_param.max_density);var r=Math.floor(t/spider_invasion_param.min_density);var s=spider_invasion_param.nb_spiders>n?n<1?1:n:Math.floor(spider_invasion_param.nb_spiders);s=s!=0&&s<r?r:s;for(i=0;i<s;++i){setTimeout(function(){spawnSpider()},Math.floor(Math.random()*400)+10)}setTimeout(function(){spawnSpidersAtRandomIntervals(s)},Math.floor(Math.random()*6e4)+5e3);e("body").on("mouseover",".spider-danger-zone",function(){zigzagDefense(e(this).data("spider"))}).on("click",".spider-danger-zone",function(){zigzagDefense(e(this).data("spider"))}).on("click",".spider-invader",function(){zigzagDefense(e(this))})})